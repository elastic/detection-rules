[hunt]
author = "Elastic"
description = """
This hunt identifies potential defense evasion techniques via multi-dot process execution on Linux systems. It looks for processes with executables that contain three or more consecutive dots in their names. Such naming conventions can be used by malicious actors to evade detection and blend in with legitimate processes.
"""
integration = ["endpoint"]
uuid = "e8a1d5c5-5678-4e8f-a69f-be234ab80e67"
name = "Potential Defense Evasion via Multi-Dot Process Execution"
language = ["ES|QL"]
license = "Elastic License v2"
notes = [
    "This query identifies processes with executables containing three or more consecutive dots in their names.",
    "The process count threshold of <= 10 can be adjusted based on the environment's baseline activity."
]
mitre = ["T1036.004", "T1070"]

query = [
'''
from logs-endpoint.events.process-*
| where @timestamp > now() - 7 day
| where host.os.type == "linux" and event.type == "start" and event.action == "exec" and process.executable rlike """.*\.{3,}.*"""
| stats process_count = count(process.executable), host_count = count(host.name) by process.executable
// Alter this threshold to make sense for your environment
| where process_count <= 10
| sort process_count asc
| limit 100
'''
]
