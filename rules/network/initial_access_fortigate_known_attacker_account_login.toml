[metadata]
creation_date = "2026/01/28"
integration = ["fortinet_fortigate"]
maturity = "production"
updated_date = "2026/01/28"

[rule]
author = ["Elastic"]
description = """
This rule detects successful logins to a FortiGate device using administrator account names that are known indicators of
compromise from the FG-IR-26-060 campaign. Threat actors exploiting FortiCloud SSO authentication bypass vulnerabilities
have been observed creating local administrator accounts with generic operational names such as audit, backup, support,
itadmin, secadmin, and remoteadmin for persistence.
"""
from = "now-9m"
interval = "5m"
language = "esql"
license = "Elastic License v2"
name = "FortiGate Login with Known Attacker Administrator Account Name"
note = """## Triage and analysis

### Investigating FortiGate Login with Known Attacker Administrator Account Name

This alert indicates that an administrator account with a name matching known threat actor IOCs successfully logged into a FortiGate device. These account names have been directly observed in campaigns exploiting CVE-2026-24858 (FG-IR-26-060).

The threat actor creates local admin accounts with generic operational names to blend in with legitimate accounts and maintain persistence after the initial SSO bypass.

### Possible investigation steps

- Verify `source.user.name` to determine whether this account was provisioned through an authorized change process. Check when the account was created by reviewing configuration change logs for `cfgpath == "system.admin"` and `action == "Add"`.
- Check `source.ip` against known threat infrastructure and internal management ranges. Compare against attacker IP IOCs from The Constant Company LLC, BL Networks, and Kaopu Cloud HK Limited.
- Look for configuration exports, firewall policy modifications, or additional account creation following the login. Check for VPN user or group creation in post-login activity.
- Run `get system admin` on the affected FortiGate to list all configured administrators and compare against the authorized administrator list for the device.

### False positive analysis

- Organizations that legitimately use generic names like "audit" or "backup" for administrator accounts.
- Service accounts with these names created through authorized change management.
- If any of these names are legitimately used in your environment, add exceptions for the specific device and account combination.

### Response and remediation

- If unauthorized, immediately disable or delete the suspicious administrator account and treat the device configuration as compromised.
- Restore from a known-clean backup and rotate all credentials including LDAP/AD accounts connected to the device.
- Check other FortiGate devices in the fleet for the same account names and upgrade FortiOS to a patched version.
- If the activity is expected, document the account purpose and consider renaming to avoid confusion with IOCs. Add a rule exception for the specific account and device combination."""
references = [
    "https://www.fortiguard.com/psirt/FG-IR-26-060",
    "https://www.fortinet.com/blog/psirt-blogs/analysis-of-sso-abuse-on-fortios",
    "https://www.elastic.co/docs/reference/integrations/fortinet_fortigate",
]
risk_score = 73
rule_id = "d08ba1ed-a0a3-4fe0-9c02-e643b9a25a03"
severity = "medium"
tags = [
    "Use Case: Threat Detection",
    "Tactic: Initial Access",
    "Resources: Investigation Guide",
    "Domain: Network",
    "Domain: Identity",
    "Data Source: Fortinet",
    "Data Source: Fortinet FortiGate",
]
timestamp_override = "event.ingested"
type = "esql"

query = '''
FROM logs-fortinet_fortigate.* metadata _id, _version, _index

| WHERE event.dataset == "fortinet_fortigate.log" and
        event.category == "authentication" and event.action == "login" and
        event.outcome == "success" and
        source.user.name IN (
          "audit", "backup", "support", "itadmin", "secadmin",
          "remoteadmin", "backupadmin", "deploy", "security", "sv"
        )

| keep @timestamp, source.ip, source.user.name, fortinet.firewall.method, observer.name, message, _id, _index, _version
'''


[[rule.threat]]
framework = "MITRE ATT&CK"
[[rule.threat.technique]]
id = "T1078"
name = "Valid Accounts"
reference = "https://attack.mitre.org/techniques/T1078/"
[[rule.threat.technique.subtechnique]]
id = "T1078.001"
name = "Default Accounts"
reference = "https://attack.mitre.org/techniques/T1078/001/"



[rule.threat.tactic]
id = "TA0001"
name = "Initial Access"
reference = "https://attack.mitre.org/tactics/TA0001/"

