[metadata]
creation_date = "2026/01/30"
integration = ["endpoint"]
maturity = "production"
updated_date = "2026/01/30"

[rule]
author = ["Elastic"]
description = """
Detects curl requests to JAMF Pro endpoints from suspicious processes like unsigned binaries or scripting 
interpreters. This indicates potential abuse of stolen JAMF credentials for lateral movement in enterprise 
macOS environments.
"""
from = "now-9m"
index = ["logs-endpoint.events.process-*"]
language = "eql"
license = "Elastic License v2"
name = "Suspicious Curl to Jamf Endpoint"
risk_score = 73
rule_id = "a8256685-9736-465b-b159-f25a172d08e8"
severity = "high"
tags = [
    "Domain: Endpoint",
    "OS: macOS",
    "Use Case: Threat Detection",
    "Tactic: Lateral Movement",
    "Tactic: Execution",
    "Data Source: Elastic Defend"
]
timestamp_override = "event.ingested"
type = "eql"
note = """## Triage and analysis

> **Disclaimer**:
> This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.

### Investigating Suspicious Curl to Jamf Endpoint

This rule detects suspicious processes making curl requests to Jamf endpoints. Threat actors may target Jamf infrastructure for lateral movement, attempting to identify managed devices or exploit management capabilities.

### Possible investigation steps

- Identify the process making requests to the Jamf endpoint.
- Verify if the Jamf endpoint is your organization's legitimate server.
- Review the authentication and activity logs on the Jamf server.
- Check for unauthorized device enrollment or policy changes.

### False positive analysis

- Legitimate Jamf management scripts may use curl for API calls.
- IT automation tools may interact with Jamf endpoints.

### Response and remediation

- Investigate the source of unauthorized Jamf API access.
- Rotate Jamf API credentials if compromise is suspected.
- Review Jamf audit logs for malicious activity.
- Strengthen Jamf server access controls.
"""
query = '''
process where host.os.type == "macos" and event.type == "start" and event.action == "exec" and
  process.name in ("curl", "nscurl") and process.command_line like "*https://jamf.*" and
  ((process.parent.code_signature.exists == false or process.parent.code_signature.trusted == false) or
   process.parent.name in ("osascript", "node", "perl", "ruby") or
   process.parent.name like "python*")
'''

[[rule.threat]]
framework = "MITRE ATT&CK"

  [rule.threat.tactic]
  name = "Lateral Movement"
  id = "TA0008"
  reference = "https://attack.mitre.org/tactics/TA0008/"

  [[rule.threat.technique]]
  name = "Software Deployment Tools"
  id = "T1072"
  reference = "https://attack.mitre.org/techniques/T1072/"

[[rule.threat]]
framework = "MITRE ATT&CK"

  [rule.threat.tactic]
  name = "Execution"
  id = "TA0002"
  reference = "https://attack.mitre.org/tactics/TA0002/"

  [[rule.threat.technique]]
  name = "Software Deployment Tools"
  id = "T1072"
  reference = "https://attack.mitre.org/techniques/T1072/"
