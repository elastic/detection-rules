[metadata]
creation_date = "2022/09/22"
maturity = "production"
updated_date = "2025/01/08"

[rule]
author = ["Elastic"]
description = """
This rule helps you test and practice using alerts with Elastic Security as you get set up. Itâ€™s not a sign of threat
activity.
"""
enabled = false
false_positives = [
    "This rule is not looking for threat activity. Disable the rule if you're already familiar with alerts.",
]
from = "now-35m"
index = ["auditbeat-*", "filebeat-*", "logs-*", "winlogbeat-*"]
interval = "30m"
language = "kuery"
license = "Elastic License v2"
max_signals = 1
name = "My First Rule"
note = """## Triage and analysis

### Disclaimer

This investigation guide was generated using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.

### Investigating My First Rule

Elastic Security leverages event data to monitor system activities. Adversaries often exploit event logs to cover tracks or execute unauthorized actions. The 'My First Rule' is a foundational query that captures all event types, serving as a baseline for understanding normal versus suspicious activities. While it doesn't target specific threats, it aids in familiarizing analysts with alert mechanisms. This is a test alert. This alert does not show threat activity. Elastic created this alert to help you understand how alerts work. For normal rules, the Investigation Guide will help analysts investigate alerts. This alert will show once every 24 hours for each host. It is safe to disable this rule.

### Possible investigation steps

- Review the alert details to understand the context and specific event that triggered the alert, focusing on the `event.kind:event` field.
- Examine the timestamp of the event to determine when the activity occurred and correlate it with other events around the same time.
- Identify the source and destination IP addresses involved in the event to assess if they are internal or external to the organization.
- Check the user account associated with the event to verify if the activity aligns with the user's normal behavior or role.
- Investigate the host or system where the event originated to gather more context about its current state and recent activities.
- Utilize Osquery to gather additional information about the system. For example, run the query `SELECT * FROM processes WHERE pid = <suspicious_pid>;` to investigate any suspicious processes.
- Analyze related logs from other security tools or systems to identify any patterns or anomalies that could indicate suspicious behavior.
- Look for any recent changes in system configurations or installed software that might explain the event.
- Cross-reference the event with known threat intelligence sources to determine if it matches any known indicators of compromise.
- Document findings and any hypotheses about the nature of the event to facilitate further investigation or handoff to other analysts.

### False positive analysis

- The 'My First Rule' captures all event types, which means it can generate alerts for routine system activities that are not indicative of malicious behavior, such as regular user logins, system updates, or scheduled tasks.
- To manage these false positives, users can create exceptions for known benign activities by identifying patterns in the event data that consistently trigger alerts but are verified as non-threatening.
- Analysts should regularly review and update exception lists to ensure that new benign activities are accounted for, reducing unnecessary alerts and focusing on potential threats.
- It's important to collaborate with IT and security teams to understand the context of frequent events and determine which can be safely excluded from triggering alerts.
- Users can leverage Elastic Security's filtering capabilities to refine the rule's query, excluding specific event types or sources that are known to generate false positives without compromising security monitoring.

### Response and remediation

- Review the alert details to understand the context and determine if it aligns with normal activity or indicates a potential issue.
- Contain the affected system by isolating it from the network to prevent further unauthorized access or damage.
- Conduct a thorough investigation to identify any unauthorized changes or suspicious activities in the system logs.
- If malicious activity is confirmed, remove any identified malware or unauthorized software from the system.
- Restore the system to its last known good state using backups or system restore points.
- Escalate the incident to the appropriate security team or management if the activity suggests a broader threat or breach.
- Implement enhanced logging policies to capture more detailed event data for future analysis and detection.
- Integrate additional security tools, such as intrusion detection systems or endpoint protection, to improve monitoring capabilities.
- Review and update security policies and procedures to address any gaps identified during the investigation.
- Conduct a post-incident review to learn from the event and strengthen the organization's security posture.

"""
references = ["https://www.elastic.co/guide/en/security/current/prebuilt-rules.html"]
risk_score = 21
rule_id = "a198fbbd-9413-45ec-a269-47ae4ccf59ce"
severity = "low"
tags = ["Use Case: Guided Onboarding"]
timestamp_override = "event.ingested"
type = "threshold"

query = '''
event.kind:event
'''



[rule.threshold]
field = ["host.name"]
value = 1

