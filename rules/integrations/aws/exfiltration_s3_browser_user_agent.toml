[metadata]
creation_date = "2026/02/06"
integration = ["aws"]
maturity = "production"
updated_date = "2026/02/06"

[rule]
author = ["Elastic"]
description = """
Identifies AWS API activity originating from the S3 Browser application based on the user agent string. S3 Browser is
a Windows client for Amazon S3 that provides a graphical interface for managing S3 buckets and objects, and supports IAM operations. While
legitimate, S3 Browser is rarely used in enterprise environments and has been observed in use by threat actors for data
exfiltration. Adversaries may prefer S3 Browser for its ease of use, bulk download capabilities, and ability to operate
outside of standard corporate tooling. Any S3 Browser activity should be validated against authorized data transfer
workflows.
"""
false_positives = [
    """
    Some organizations may have legitimate use cases for S3 Browser, particularly in development or data migration
    scenarios. Verify whether the IAM principal, source network, and accessed buckets align with approved workflows.
    Unexpected S3 Browser activity, especially accessing sensitive buckets, should be investigated.
    """,
]
from = "now-6m"
index = ["logs-aws.cloudtrail-*"]
language = "eql"
license = "Elastic License v2"
name = "AWS API Activity from S3 Browser Client"
note = """## Triage and Analysis

### Investigating AWS API Activity from S3 Browser Client

S3 Browser is a Windows-based graphical client for Amazon S3 that allows users to browse, upload, download, and manage S3 objects. While it is a legitimate tool, it is uncommonly used in enterprise environments where organizations typically standardize on AWS CLI, SDKs, or console access. The presence of S3 Browser in AWS CloudTrail logs may indicate unauthorized data access or exfiltration activity.

This detection identifies successful API calls made using the S3 Browser user agent string. Threat actors have been observed using S3 Browser for its intuitive interface and bulk data transfer capabilities during post-compromise data theft operations.

### Possible investigation steps

- **Identify the actor**
  - Review `aws.cloudtrail.user_identity.arn` and `aws.cloudtrail.user_identity.access_key_id` to determine which IAM principal was used.
  - Check whether this principal normally accesses S3 and whether S3 Browser usage is expected or authorized.

- **Review accessed resources**
  - Examine `aws.cloudtrail.resources.arn` to identify which S3 buckets and objects were accessed.
  - Determine whether the accessed data is sensitive, confidential, or subject to data protection policies.
  - Look for patterns indicating bulk downloads or systematic enumeration of bucket contents.

- **Analyze the actions performed**
  - Review `event.action` to understand what S3 operations were performed (e.g., `GetObject`, `ListBucket`, `PutObject`).
  - High volumes of `GetObject` calls may indicate data exfiltration.
  - `PutObject` calls could indicate staging of exfiltrated data or ransomware note placement.

- **Inspect source network context**
  - Review `source.ip` and `source.geo` fields to determine the origin of the request.
  - Check whether the IP belongs to corporate infrastructure, VPN, or an unexpected external location.
  - External IPs combined with S3 Browser usage are high-risk indicators.

- **Correlate with surrounding activity**
  - Search for additional CloudTrail events from the same access key or session.
  - Look for preceding credential theft indicators such as `GetSecretValue`, `CreateAccessKey`, or console logins.
  - Check for other exfiltration indicators like `CreateBucket` in external accounts or snapshot sharing.

### False positive analysis

- **Authorized data migration or backup activities** may use S3 Browser. Confirm with data engineering or IT teams.
- **Developer testing** in non-production environments may occasionally involve S3 Browser. Validate the environment and data sensitivity.

### Response and remediation

- **If unauthorized**, immediately revoke or rotate the affected access keys and invalidate active sessions.
- **Assess data exposure** by reviewing which objects were accessed and determining if sensitive data was compromised.
- **Notify security operations** and initiate incident response procedures if exfiltration is confirmed.
- **Implement preventive controls** such as S3 bucket policies restricting access by user agent or requiring VPC endpoints.
- **Enable S3 access logging** if not already configured to capture detailed object-level access patterns.

### Additional information
- **[AWS IR Playbooks](https://github.com/aws-samples/aws-incident-response-playbooks/blob/c151b0dc091755fffd4d662a8f29e2f6794da52c/playbooks/)**
- **[AWS Customer Playbook Framework](https://github.com/aws-samples/aws-customer-playbook-framework/tree/a8c7b313636b406a375952ac00b2d68e89a991f2/docs)**
- **[AWS Knowledge Center â€“ Security Best Practices](https://aws.amazon.com/premiumsupport/knowledge-center/security-best-practices/)**
"""
references = [
    "https://s3browser.com/",
    "https://permiso.io/blog/lucr-3-scattered-spider-getting-saas-y-in-the-cloud",
]
risk_score = 47
rule_id = "73344d2d-9cfb-4daf-b3c5-1d40a8182b86"
severity = "medium"
tags = [
    "Domain: Cloud",
    "Data Source: AWS",
    "Data Source: Amazon Web Services",
    "Data Source: AWS CloudTrail",
    "Data Source: AWS S3",
    "Tactic: Exfiltration",
    "Use Case: Cloud Threat Detection",
    "Resources: Investigation Guide",
]
timestamp_override = "event.ingested"
type = "eql"

query = '''
any where event.dataset == "aws.cloudtrail"
    and stringContains~(user_agent.original, "S3 Browser")
    and event.outcome == "success"
'''


[[rule.threat]]
framework = "MITRE ATT&CK"
[[rule.threat.technique]]
id = "T1567"
name = "Exfiltration Over Web Service"
reference = "https://attack.mitre.org/techniques/T1567/"
[[rule.threat.technique.subtechnique]]
id = "T1567.002"
name = "Exfiltration to Cloud Storage"
reference = "https://attack.mitre.org/techniques/T1567/002/"



[rule.threat.tactic]
id = "TA0010"
name = "Exfiltration"
reference = "https://attack.mitre.org/tactics/TA0010/"

[rule.investigation_fields]
field_names = [
    "@timestamp",
    "user.name",
    "user_agent.original",
    "source.ip",
    "aws.cloudtrail.user_identity.arn",
    "aws.cloudtrail.user_identity.type",
    "aws.cloudtrail.user_identity.access_key_id",
    "aws.cloudtrail.resources.arn",
    "aws.cloudtrail.resources.type",
    "event.action",
    "event.outcome",
    "cloud.account.id",
    "cloud.region",
    "aws.cloudtrail.request_parameters",
    "aws.cloudtrail.response_elements",
]

