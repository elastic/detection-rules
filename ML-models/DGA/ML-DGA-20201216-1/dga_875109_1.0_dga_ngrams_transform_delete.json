{"script": {"lang": "painless", "source": "\n    def top_classes = ctx['ml_is_dga']['top_classes'];\n    def malicious_probability = 0.0;\n    def malicious_prediction = ctx['ml_is_dga']['malicious_prediction'];\n    for (def class: top_classes) {\n      if (class['class_name'] == 1) {\n        malicious_probability = class['class_probability'];\n      }\n    }\n    ctx.remove('ml_is_dga');\n    ctx.remove('f');\n    ctx['ml_is_dga'] = new HashMap();\n    ctx['ml_is_dga']['malicious_prediction'] = malicious_prediction;\n    ctx['ml_is_dga']['malicious_probability'] = malicious_probability;\n    "}}